<!DOCTYPE html>
<meta charset='utf-8'>
<script>
    // 안쪽은 "" 로 바깥쪽을 꼭 '' 로 해야 함
    var v_text = '{"name":"단비", "alias":"천재"}';
    var v_danbi = JSON.parse(v_text);
    // alert(v_danbi.alias);
    
    // 요즘 유행하는 return 타입이 Promise 인 Ajax library Axios
    var axios = {}; // namespace 용 빈 객체
    axios.get = function(p_url){
        return new Promise((resolve, reject)=>{
            var v_ajax = new XMLHttpRequest();
            // v_ajax.open("메소드", "URL", 비동기여부);
            v_ajax.open("get", p_url, true);
            v_ajax.onreadystatechange = function(){
                if(v_ajax.readyState == 4 && v_ajax.status == 200){
                    resolve(v_ajax.responseText); // 성공하면 resolve 에게 필요한 값 넘김
                }
            }
            v_ajax.send();
        })
    }
/*
    axios.get("./dummy.txt").then((p_rslt)=> {
        var v_arr = JSON.parse(p_rslt);
        alert("넘어온 값은 " + v_arr[1]); // 제니 만 번지점프
    });
*/
    // alert("요거 다시 확인"); // 요걸로 Promise 는 비동기 처리됨을 다시 한번 확인
    // async, await 키워드가 최종 출현
    // Promise 에 대한 불만 해소를 위해 출현, 그 근본은 Promise 를 바탕으로 동작
    // 엄청 칭찬 받는 키워드
    // await 를 쓰는 함수는 꼭 async 로 정의되어야 함.(이것이 핵심)

    // 요기서 처음 공부하는 사람들의 async, awati 키워드에 대한 오해가 시작
    // 성능향상을 위해서 비동기를 사용하는 데 그것을 동기화 시켜버리면 무슨 의미가?
    // 순서(동기)가 필요한 부분을 await 를 사용해서 동기화 시켜버리지만
    // 그 동기화 블락을 감싼 함수가 비동기로 동작하기 때문에
    // 함수 안의 코드는 인간의 뇌가 이해하기 좋은 동기식으로 이해하면서
    // 비동기의 성능향상 장점까지 모두 잡음.(키워드에 대한 칭찬이 하늘을 찌름)

    // 참고로 프론트엔드 성능향상이 너무 많이 요구 되어서 웹 어셈블리가
    // 공식화 되진 않았지만, 준비되어 있고 많이 회사들이 적용할지 여부를 실험중
    // C언어로 함수르 ㄹ짜공, 제어는 자바스크립트로 하는 미래를 준비
    async function f_test(){
        var v_rslt = await axios.get("./dummy.txt");
        // alert(v_rslt);
        return v_rslt;
    }

    f_test().then((p_fbi)=> {
        alert(p_fbi);
    });

    // alert("혜원인 밀접 접촉자?");
</script>